# Migration `20200725161325-toto`

This migration has been generated by Tom Chauveau at 7/25/2020, 4:13:25 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
CREATE TYPE "Status" AS ENUM ('Todo', 'InProgress', 'Done');

CREATE TABLE "public"."Project" (
"id" text  NOT NULL ,
"name" text  NOT NULL ,
"description" text   ,
"image" text   ,
"status" "Status" NOT NULL ,
"airtable" text   ,
"github" text   ,
PRIMARY KEY ("id"))

CREATE TABLE "public"."Role" (
"id" text  NOT NULL ,
"name" text  NOT NULL ,
"color" text   ,
"admin" boolean   DEFAULT false,
"add_role" boolean   DEFAULT false,
"recommend" boolean   DEFAULT false,
"write" boolean   DEFAULT false,
"add_member" boolean   DEFAULT false,
"create_pro" boolean   DEFAULT false,
PRIMARY KEY ("id"))

CREATE TABLE "public"."User" (
"id" text  NOT NULL ,
"mail" text  NOT NULL ,
"profil_pic" text   ,
"token" text   ,
PRIMARY KEY ("id"))

CREATE TABLE "public"."_ProjectToUser" (
"A" text  NOT NULL ,
"B" text  NOT NULL )

CREATE TABLE "public"."_RoleToUser" (
"A" text  NOT NULL ,
"B" text  NOT NULL )

CREATE UNIQUE INDEX "Project.name" ON "public"."Project"("name")

CREATE UNIQUE INDEX "Role.name" ON "public"."Role"("name")

CREATE UNIQUE INDEX "User.mail" ON "public"."User"("mail")

CREATE UNIQUE INDEX "User.token" ON "public"."User"("token")

CREATE UNIQUE INDEX "_ProjectToUser_AB_unique" ON "public"."_ProjectToUser"("A","B")

CREATE  INDEX "_ProjectToUser_B_index" ON "public"."_ProjectToUser"("B")

CREATE UNIQUE INDEX "_RoleToUser_AB_unique" ON "public"."_RoleToUser"("A","B")

CREATE  INDEX "_RoleToUser_B_index" ON "public"."_RoleToUser"("B")

ALTER TABLE "public"."_ProjectToUser" ADD FOREIGN KEY ("A")REFERENCES "public"."Project"("id") ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE "public"."_ProjectToUser" ADD FOREIGN KEY ("B")REFERENCES "public"."User"("id") ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE "public"."_RoleToUser" ADD FOREIGN KEY ("A")REFERENCES "public"."Role"("id") ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE "public"."_RoleToUser" ADD FOREIGN KEY ("B")REFERENCES "public"."User"("id") ON DELETE CASCADE ON UPDATE CASCADE
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration ..20200725161325-toto
--- datamodel.dml
+++ datamodel.dml
@@ -1,0 +1,53 @@
+// This is your Prisma schema file,
+// learn more about it in the docs: https://pris.ly/d/prisma-schema
+
+datasource db {
+  provider = "postgresql"
+  url = "***"
+}
+
+generator client {
+  provider = "prisma-client-js"
+}
+
+// Project
+enum Status {
+  Todo
+  InProgress
+  Done
+}
+
+model Project {
+  id          String  @default(uuid()) @id
+  name        String  @unique
+  description String?
+  image       String?
+  status      Status
+  airtable    String?
+  github      String?
+  users       User[]  @relation(references: [id])
+}
+
+// Roles
+model Role {
+  id         String   @default(uuid()) @id
+  name       String   @unique
+  color      String?
+  admin      Boolean? @default(false)
+  add_role   Boolean? @default(false)
+  recommend  Boolean? @default(false)
+  write      Boolean? @default(false)
+  add_member Boolean? @default(false)
+  create_pro Boolean? @default(false)
+  users      User[]   @relation(references: [id])
+}
+
+// User model
+model User {
+  id         String    @default(uuid()) @id
+  mail       String    @unique
+  profil_pic String?
+  token      String?   @unique
+  roles      Role[]    @relation(references: [id])
+  projects   Project[] @relation(references: [id])
+}
```


